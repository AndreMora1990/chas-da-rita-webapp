<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>ChÃ¡s da Rita - V7</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script>
    let produtos = {
      'ChÃ¡s': [
        { nome: 'ChÃ¡ Verde', quantidade: 100, unidade: 'g', preco: 3.5 },
        { nome: 'ChÃ¡ Preto', quantidade: 100, unidade: 'g', preco: 3.2 },
        { nome: 'ChÃ¡ Branco', quantidade: 50, unidade: 'g', preco: 4.5 },
        { nome: 'ChÃ¡ Oolong', quantidade: 50, unidade: 'g', preco: 4.0 },
        { nome: 'ChÃ¡ de Jasmim', quantidade: 50, unidade: 'g', preco: 3.8 },
        { nome: 'ChÃ¡ de LÃºcia-lima', quantidade: 50, unidade: 'g', preco: 2.5 }
      ],
      'Tisanas': [
        { nome: 'Tisana de Camomila', quantidade: 50, unidade: 'g', preco: 2.0 },
        { nome: 'Tisana de Erva-prÃ­ncipe', quantidade: 50, unidade: 'g', preco: 2.0 }
      ],
      'Especiarias': [
        { nome: 'Golden Milk', quantidade: 25, unidade: 'g', preco: 1.25 },
        { nome: 'Chai Massala', quantidade: 50, unidade: 'g', preco: 2.2 }
      ],
      'AcessÃ³rios': [
        { nome: 'Infusor Bola Inox', quantidade: 1, unidade: 'unid.', preco: 3.0 }
      ],
      'Biscoitos': [
        { nome: 'Biscoitos de AmÃªndoa', quantidade: 1, unidade: 'unid.', preco: 0.5 }
      ],
      'AmÃªndoas': [
        { nome: 'AmÃªndoas Caramelizadas', quantidade: 100, unidade: 'g', preco: 3.0 }
      ],
      'Outros': [
        { nome: 'Cacau em pÃ³ artesanal', quantidade: 100, unidade: 'g', preco: 2.8 }
      ]
    };

    let editarProdutoCat = null;
    let editarProdutoIdx = null;

    function abrirGestao() {
      const lista = Object.entries(produtos).map(([cat, items]) =>
        items.map((p, i) => `<li>${p.nome} (${p.quantidade}${p.unidade} - â‚¬${p.preco.toFixed(2)}) 
        <button onclick="editarProduto('${cat}', ${i})">Editar</button></li>`).join("")
      ).join("");
      document.getElementById('lista').innerHTML = lista;
      document.getElementById('gestao').style.display = 'block';
    }

    function editarProduto(cat, idx) {
      const p = produtos[cat][idx];
      editarProdutoCat = cat;
      editarProdutoIdx = idx;
      document.getElementById('nome').value = p.nome;
      document.getElementById('quantidade').value = p.quantidade;
      document.getElementById('unidade').value = p.unidade;
      document.getElementById('preco').value = p.preco;
      document.getElementById('formulario').style.display = 'block';
    }

    function guardarProduto() {
      const p = {
        nome: document.getElementById('nome').value,
        quantidade: parseFloat(document.getElementById('quantidade').value),
        unidade: document.getElementById('unidade').value,
        preco: parseFloat(document.getElementById('preco').value)
      };
      if (editarProdutoCat && editarProdutoIdx !== null) {
        produtos[editarProdutoCat][editarProdutoIdx] = p;
      }
      document.getElementById('formulario').style.display = 'none';
      abrirGestao();
    }
  </script>
</head>
<body>
  <h1>ChÃ¡s da Rita ðŸŒ¿</h1>
  <button onclick="abrirGestao()">Gerir Produtos</button>

  <div id="gestao" style="display:none">
    <h2>Lista de Produtos</h2>
    <ul id="lista"></ul>
  </div>

  <div id="formulario" style="display:none">
    <h3>Editar Produto</h3>
    <input id="nome" placeholder="Nome"><br>
    <input id="quantidade" placeholder="Quantidade"><br>
    <select id="unidade"><option>g</option><option>unid.</option></select><br>
    <input id="preco" placeholder="PreÃ§o"><br>
    <button onclick="guardarProduto()">Guardar</button>
  </div>
</body>
</html>
